\chapter{Shell}

\section{Description}
The Shell module is Priors Command Line Interface (CLI) that can be enabled by setting \TODO{ref} \textit{PRTOS\_CONFIG\_ENABLE\_SHELL} to 1.\\
The Shell is accessible through any desired communication port, the default is UART. Commands are entered as text and suffixed with a \TODO{backslash N} to indicate the end of the command. A typical reply is prefixed with psh> (which can in turn be prefixed by a time-stamp if enabled).
\begin{pditemize}
	\item Spaces are allowed but have no effect on the meaning of the command.
	\item Command arguments have to be prefixed with -.
	\item Assigning values to command arguments have to be assigned using =.
\end{pditemize} 
Example: \textit{help -c=cfg}, Displays the help menu of the \textit{cfg} command.

In addition to using the built-in Shell commands, it is also possible to add custom commands to the command-set using the Shell's API.


\section{Commands}

\subsection{\textit{help}}
 Displays a list of all available commands if no arguments are passed.\\
 Displays the help menu for the passed command name if this is given.

\begin{pdtable}{tbl:shcmdhelp}{help command argument(s)}
	\begin{pdtabular}{c|l|l|l|p{7.5cm}}
		\pdtablehead{\textbf{Optional} & \textbf{Argument name} &\textbf{Format} &\textbf{Command argument} &\textbf{Description}}
		\pdtablerow{X & Command name & String & -c=<string> & Name of the command for which the help menu should be displayed. }
	\end{pdtabular}
\end{pdtable}

\subsection{\textit{kstat}}
Prints the kernel statistics such as current frequency, memory usage, uptime, number of tasks, 
number of events, execution queue, etc.\\
The \textit{kstat} command has no arguments.


\subsection{\textit{tstat}}
Prints all existing task's statistics such as average run-time and state.\\
The \textit{tstat} command has no arguments.

\subsection{\textit{run}}
The specified task is scheduled to run.

\begin{pdtable}{tbl:shcmdrun}{run command argument(s)}
	\begin{pdtabular}{c|l|l|l|p{7.5cm}}
		\pdtablehead{\textbf{Optional} & \textbf{Argument name} &\textbf{Format} &\textbf{Command argument} &\textbf{Description}}
		\pdtablerow{ & Task ID & Hex(4) & -t=<100A>or<100a> & Task to run. }
		\pdtablerow{X & Force run & Boolean & -f & Forces the scheduler to run this task immediately.}
	\end{pdtabular}
\end{pdtable}

\subsection{\textit{lock}}
Locks or unlocks an object in read mode.
If no mode argument is passed, the object's current lock state is printed.

\begin{pdtable}{tbl:shcmdlock}{lock command argument(s)}
	\begin{pdtabular}{c|l|l|l|p{7.5cm}}
		\pdtablehead{\textbf{Optional} & \textbf{Argument name} &\textbf{Format} &\textbf{Command argument} &\textbf{Description}}
		\pdtablerow{ & Object ID & Hex(4) & -o=<100A>or<100a> & Object to lock/unlock. }
		\pdtablerow{X & Lock mode & Boolean & -l & The object will be locked.}
		\pdtablerow{X & Unlock mode & Boolean & -u & The object will be unlocked.}
	\end{pdtabular}
\end{pdtable}

\subsection{\textit{lsprint}}
Prints the details of a list.


\begin{pdtable}{tbl:shcmdlsprint}{lsprint command argument(s)}
	\begin{pdtabular}{c|l|l|l|p{7.5cm}}
		\pdtablehead{\textbf{Optional} & \textbf{Argument name} &\textbf{Format} &\textbf{Command argument} &\textbf{Description}}
		\pdtablerow{ & List & Enum & -l=<list> 0=exeq, 1=tcb, 2=tcbw,  & Task to run. }
		\pdtablerow{X & Force run & Boolean & -f & Forces the scheduler to run this task immediately.}
	\end{pdtabular}
\end{pdtable}


\newpage
\input{contents/sec_Shell.tex}


 