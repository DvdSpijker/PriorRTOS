\ProvidesPackage{prodrive/package/pddocumenthistory}
\RequirePackage{prodrive/package/pdtabularx}
\RequirePackage{tabularx}
\RequirePackage{xifthen}

\newenvironment{pddocumenthistory}%
{%
	\begingroup
	\let\clearpage\relax
	\chapter*{Document history}
	\endgroup
	\pdtabularx{\textwidth}{l|l|X}
		\pdtablehead{Rel. & Date & Changes}
}
{%
	\endpdtabularx%
}%

\newenvironment{pddocumenthistoryS}
{
	\begingroup
	\let\clearpage\relax
	\chapter*{Document history}
	\endgroup
	\pdtabularx{\textwidth}{l|l|l|X}
		\pdtablehead{Rel. & Date & Status & Changes}
}
{
	\endpdtabularx%
}

\newenvironment{pddocumenthistory*}
{%
	\pdtabularx{\textwidth}{l|l|X}
		\pdtablehead{Rel. & Date & Changes}
}
{%
	\endpdtabularx%
}%

\newenvironment{pddocumenthistoryS*}%
{%
	\pdtabularx{\textwidth}{l|l|l|X}
		\pdtablehead{Rel. & Date & Status & Changes}
}
{%
	\endpdtabularx%
}%

% Document history release counter
\newcounter{pddocumenthistorycount}

% Document history entry macro
\newcommand{\pddocumenthistoryrow}[2]
{%
	\addtocounter{pddocumenthistorycount}{1}%
	\pdtablerow{%
		% column Release
		R\ifthenelse{\value{pddocumenthistorycount} < 10}{0}{}\arabic{pddocumenthistorycount} &%
		%
		% column Date
		#1 &%
		%
		% column Changes
		\begin{minipage}[t]{\linewidth}%
		#2%
		\smallskip%
		\end{minipage}%
	}
}

\newcommand{\pddocumenthistoryrowS}[3]
{%
	\addtocounter{pddocumenthistorycount}{1}%
	\pdtablerow{%
		% column Release
		R\ifthenelse{\value{pddocumenthistorycount} < 10}{0}{}\arabic{pddocumenthistorycount} &%
		%
		% column Date
		#1 &%
		%
		% column Status
		#2 &%
		%
		% column Changes
		\begin{minipage}[t]{\linewidth}%
		#3%
		\smallskip%
		\end{minipage}%
	}
}

